"use strict";angular.module("gituser",["ngSanitize","ngRoute","gituser.services","gituser.controllers"]).config(["$routeProvider","$locationProvider",function(e,t){e.when("/",{templateUrl:"public/partials/gituser.html",controller:"gitUserCtrl"}).when("/user/:userName",{templateUrl:"public/partials/gituser-projects.html",controller:"gitUserProfileCtrl"}).when("/user/:userName/:projectName",{templateUrl:"public/partials/gituser-project.html",controller:"gitUserProjectCtrl"})}]);var Controllers=angular.module("gituser.controllers",[]);Controllers.controller("gitUserCtrl",["$scope","GitHubApi","$routeParams","$window",function(t,e,r,o){t.vm={userName:r.userName||"",userNameChange:function(){return t.vm.isLoading=!0,t.vm.untouched=!1,e.getUserData(t.vm.userName).then(function(){t.vm.isLoading=!1,t.vm.isValid=!0}).catch(function(){t.vm.isLoading=!1,t.vm.isValid=!1})},isValid:!1,isLoading:!1,untouched:!0,modelOpts:{debounce:500},goToProjects:function(){if(!t.vm.isValid||t.vm.isLoading)return;o.location.href="#!/user/"+t.vm.userName},keyPress:function(e){13===e.keyCode&&t.vm.goToProjects()}}}]),Controllers.controller("gitUserProfileCtrl",["$scope","GitHubApi","$routeParams","$window",function(t,e,r,o){t.vm={isLoading:!0,userName:r.userName||"",goBack:function(){o.location.href="#!/"},goToProject:function(e){o.location.href="#!/user/"+t.vm.userName+"/"+e}},e.getUserProjects(t.vm.userName).then(function(e){t.vm.isLoading=!1,t.vm.projects=e.repos}).catch(function(){t.vm.goBack()})}]),Controllers.controller("gitUserProjectCtrl",["$scope","GitHubApi","$routeParams","$window",function(t,e,r,o){t.vm={isLoading:!0,userName:r.userName||"",projectName:r.projectName||"",goBack:function(){o.location.href="#!/user/"+t.vm.userName},readMe:null},e.getProjectReadme(t.vm.userName,t.vm.projectName).then(function(e){t.vm.isLoading=!1,t.vm.readMe=e}).catch(function(){t.vm.isLoading=!1})}]);var Services=angular.module("gituser.services",[]);Services.service("GitHubApi",["$http","$window",function(r,o){var n={location:"https://api.github.com/",getUserData:function(e){return n.request("users/"+e).then(function(e){return e.data})},getUserProjects:function(t){var r=null;return n.request("users/"+t).then(function(e){return r=e.data,n.request("users/"+t+"/repos").then(function(e){return r.repos=e.data,r})})},getProjectReadme:function(e,t){return n.request("repos/"+e+"/"+t+"/readme",!0).then(function(e){return e.data})},getRequestParams:function(e,t){var r={};t&&(r.Accept="application/vnd.github.html");return{method:"GET",headers:r,url:n.location+e}},request:function(e,t){return r(n.getRequestParams(e,t)).catch(function(e){401===e.status&&"Unauthorized"===e.statusText&&(alert("the github api token ahd expired."),o.location="/")})}};return n}]);
